(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{445:function(s,t,a){"use strict";a.r(t);var n=a(14),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"history"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#history"}},[s._v("#")]),s._v(" history")]),s._v(" "),t("h2",{attrs:{id:"history依赖包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#history依赖包"}},[s._v("#")]),s._v(" history依赖包")]),s._v(" "),t("p",[s._v("依赖包  https://github.com/ReactTraining/history")]),s._v(" "),t("h3",{attrs:{id:"提供的三个方法"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#提供的三个方法"}},[s._v("#")]),s._v(" 提供的三个方法")]),s._v(" "),t("ul",[t("li",[s._v("createBrowserHistory"),t("br"),s._v("\n用在支持H5的现代浏览器中")]),s._v(" "),t("li",[s._v("createMemoryHistory"),t("br"),s._v("\n用做参考工具或非DOM环境中,例如ReactNative和测试环境")]),s._v(" "),t("li",[s._v("createHashHistory"),t("br"),s._v("\n用于传统浏览器中")])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("// 用法\nimport { createBrowserHistory } from 'history';\n\nconst history = createBrowserHistory();\n\n// Get the current location.\nconst location = history.location;\n\n// Listen for changes to the current location.\nconst unlisten = history.listen((location, action) => {\n  // location is an object like window.location\n  console.log(action, location.pathname, location.state);\n});\n\n// Use push, replace, and go to navigate around.\nhistory.push('/home', { some: 'state' });\n\n// To stop listening, call the function returned from listen().\nunlisten();\n\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("h3",{attrs:{id:"属性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#属性"}},[s._v("#")]),s._v(" 属性")]),s._v(" "),t("ul",[t("li",[s._v("history.length  历史堆栈中的条目数")]),s._v(" "),t("li",[s._v("history.location 当前位置")]),s._v(" "),t("li",[s._v("history.action 当前的导航动作")])]),s._v(" "),t("h3",{attrs:{id:"监听-listening"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#监听-listening"}},[s._v("#")]),s._v(" 监听 listening")]),s._v(" "),t("p",[s._v("使用history.listen来监听当前location的变化")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("history.listen(\n    (location, action) => {\n        console.log(\n            `The current URL is ${location.pathname}${location.search}${location.hash}`\n        );\n        console.log(`The last navigation action was ${action}`);\n    }\n)\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("p",[s._v("location对象参考了window.location的接口子集，包括")]),s._v(" "),t("ul",[t("li",[s._v("location.pathname - The path of the URL")]),s._v(" "),t("li",[s._v("location.search - The URL query string")]),s._v(" "),t("li",[s._v("location.hash - The URL hash fragment")])]),s._v(" "),t("p",[s._v("location对象具有属性")]),s._v(" "),t("ul",[t("li",[s._v("location.state"),t("br"),s._v("\n不在URL中展示的一些额外状态(支持 createBrowserHistory 和 createMemoryHistory)")]),s._v(" "),t("li",[s._v("location.key - 当前location唯一的标志 (supported in createBrowserHistory and createMemoryHistory)")])]),s._v(" "),t("p",[s._v("记得移除监听")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("const unlisten = history.listen(myListener);\n// ...\nunlisten();\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"navigation"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#navigation"}},[s._v("#")]),s._v(" Navigation")]),s._v(" "),t("p",[s._v("改变location的方法")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("history.push(path, [state])\nhistory.replace(path, [state])\nhistory.go(n)\nhistory.goBack()\nhistory.goForward()\nhistory.canGo(n) (only in createMemoryHistory)\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br")])]),t("h3",{attrs:{id:"使用基本url"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#使用基本url"}},[s._v("#")]),s._v(" 使用基本URL")]),s._v(" "),t("p",[s._v("如果您应用中的所有网址都基于某个特定地址，请使用该basename选项。此选项透明地将给定字符串添加到您使用的所有URL的前面。")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("const history = createHistory({\n  basename: '/the/base'\n});\n\nhistory.listen(location => {\n  console.log(location.pathname); // /home\n});\n\nhistory.push('/home'); // URL is now /the/base/home\n\n//basename is not supported in createMemoryHistory.\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("hr"),s._v(" "),t("h2",{attrs:{id:"react-router-的-history对象"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#react-router-的-history对象"}},[s._v("#")]),s._v(" react-router 的 history对象")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("length - (number) The number of entries in the history stack\n\naction - (string) The current action (PUSH, REPLACE, or POP)\n\nlocation\n(object) The current location. May have the following properties:\n    pathname - (string) The path of the URL\n    search - (string) The URL query string\n    hash - (string) The URL hash fragment\n    state - (object) location-specific state that was provided to e.g. push(path, state) when this location was pushed onto the stack. Only available in browser and memory history.\n    \n    \npush(path, [state]) - (function) Pushes a new entry onto the history stack\n\nreplace(path, [state]) - (function) Replaces the current entry on the history stack\n\ngo(n) - (function) Moves the pointer in the history stack by n entries\n\ngoBack() - (function) Equivalent to go(-1)\n\ngoForward() - (function) Equivalent to go(1)\n\nblock(prompt) - (function) Prevents navigation (see the history docs)\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br")])]),t("h4",{attrs:{id:"history是可变的"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#history是可变的"}},[s._v("#")]),s._v(" history是可变的")]),s._v(" "),t("p",[s._v("历史对象是可变的。因此建议从"),t("code",[s._v("<Route>")]),s._v("的props中拿到location，而不是从history.location。这可以确保您在生命周期钩子中对React的假设是正确的。")]),s._v(" "),t("h4",{attrs:{id:"location"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#location"}},[s._v("#")]),s._v(" location")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("{\n  key: 'ac3df4', // not with HashHistory!\n  pathname: '/somewhere'\n  search: '?some=search-string',\n  hash: '#howdy',\n  state: {\n    [userDefined]: true\n  }\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br")])]),t("h4",{attrs:{id:"match"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#match"}},[s._v("#")]),s._v(" match")]),s._v(" "),t("p",[s._v("一个match对象包含"),t("code",[s._v("<Route path>")]),s._v("如何与URL匹配的相关信息。"),t("br"),s._v("\nmatch对象包含以下属性：")]),s._v(" "),t("ul",[t("li",[s._v("params - （对象）从与路径的动态段对应的URL解析的键/值对")]),s._v(" "),t("li",[s._v("isExact - （boolean）true如果整个URL匹配（没有尾随字符）")]),s._v(" "),t("li",[s._v("path -（字符串）用于匹配的路径模式。用于构建嵌套的"),t("code",[s._v("<Route>")]),s._v("s")]),s._v(" "),t("li",[s._v("url - （字符串）URL的匹配部分。用于构建嵌套的"),t("code",[s._v("<Link>")]),s._v("s")])]),s._v(" "),t("p",[s._v("如果Route没有path，因此始终匹配，您将获得最接近的父match。同样用于withRouter。")]),s._v(" "),t("p",[s._v("Pathless "),t("code",[s._v("<Route>")]),s._v("s inherit their match object from their parent."),t("br"),s._v("\nIf their parent match is null, then their match will also be null. This means that"),t("br"),s._v("\na) any child routes/links will have to be absolute because there is no parent to resolve with and"),t("br"),s._v("\nb) a pathless route whose parent match can be null will need to use the children prop to render.")]),s._v(" "),t("h4",{attrs:{id:"matchpath"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#matchpath"}},[s._v("#")]),s._v(" matchPath")]),s._v(" "),t("p",[s._v("这使您可以使用在"),t("code",[s._v("<Route>")]),s._v("正常渲染周期之外使用的相同匹配代码，例如在服务器上呈现之前收集数据依赖性。")]),s._v(" "),t("p",[s._v("第一个参数是您要匹配的路径名。如果你在使用Node.js的服务器上使用它，那就是req.path。")]),s._v(" "),t("p",[s._v("第二个参数是match的样式，它们与Route接受的match参数一样。 它也可以是字符串或字符串数组作为{ path }的快捷方式：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("{\n  path, // like /users/:id; either a single string or an array of strings\n  strict, // optional, defaults to false\n  exact, // optional, defaults to false\n}\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('import { matchPath } from "react-router";\n\nconst match = matchPath("/users/123", {\n  path: "/users/:id",\n  exact: true,\n  strict: false\n});\n\nmatchPath("/users/2", {\n      path: "/users/:id",\n      exact: true,\n      strict: true\n    })\n\n//  {\n//    isExact: true\n//    params: {\n//        id: "2"\n//    }\n//    path: "/users/:id"\n//    url: "/users/2"\n//  }\n\nmatchPath("/users", {\n      path: "/users/:id",\n      exact: true,\n      strict: true\n    })\n\n//  null\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br")])]),t("h4",{attrs:{id:"withrouter"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#withrouter"}},[s._v("#")]),s._v(" withRouter")]),s._v(" "),t("p",[s._v("你可以访问history对象的属性和最近"),t("code",[s._v("<Route>")]),s._v("的match经withRouter高阶组件。每当渲染时，withRouter都会将更新的match，location和history道具传递给包装的组件。")]),s._v(" "),t("p",[s._v("重要的提示"),t("br"),s._v("\nwithRouter不会订阅React Redux connect对状态更改所做的位置更改。而是在位置更改后从"),t("code",[s._v("<Router>")]),s._v("组件传播出来时重新渲染。这意味着，withRouter它不会对路线的转变重新呈现，除非它的父组件重新呈现。")])])}),[],!1,null,null,null);t.default=e.exports}}]);