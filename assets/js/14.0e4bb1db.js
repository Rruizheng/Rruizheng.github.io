(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{359:function(t,a,s){t.exports=s.p+"assets/img/1.2197b826.png"},360:function(t,a,s){t.exports=s.p+"assets/img/2.00038609.png"},361:function(t,a,s){t.exports=s.p+"assets/img/3.d36e8d45.png"},362:function(t,a,s){t.exports=s.p+"assets/img/4.dc3e73ee.png"},363:function(t,a,s){t.exports=s.p+"assets/img/5.3b86e78a.png"},364:function(t,a,s){t.exports=s.p+"assets/img/6.d8dbe92b.png"},365:function(t,a,s){t.exports=s.p+"assets/img/7.50eff17c.png"},366:function(t,a,s){t.exports=s.p+"assets/img/8.446ad5d6.png"},367:function(t,a,s){t.exports=s.p+"assets/img/9.a8acd2f7.png"},368:function(t,a,s){t.exports=s.p+"assets/img/10.0608e4c4.png"},369:function(t,a,s){t.exports=s.p+"assets/img/11.8b02ed3f.png"},370:function(t,a,s){t.exports=s.p+"assets/img/12.7ab9f470.png"},450:function(t,a,s){"use strict";s.r(a);var e=s(14),n=Object(e.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"前端性能监控方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前端性能监控方案"}},[t._v("#")]),t._v(" 前端性能监控方案")]),t._v(" "),a("p",[t._v("一般来说，前端性能监控会采用两种形式。")]),t._v(" "),a("ul",[a("li",[t._v("统计用户测的真实使用数据，sdk采集上报分析，自定义埋点上报")]),t._v(" "),a("li",[t._v("实验室合成测试监控，模拟场景和数据")])]),t._v(" "),a("p",[t._v("实验室合成测试监控:\n"),a("img",{attrs:{src:s(359),alt:"image.png"}}),t._v("\n真实用户监控：\n"),a("img",{attrs:{src:s(360),alt:"image.png"}})]),t._v(" "),a("p",[t._v("无论是哪种方式，性能指标的确定都是非常重要的")]),t._v(" "),a("h1",{attrs:{id:"性能指标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#性能指标"}},[t._v("#")]),t._v(" 性能指标")]),t._v(" "),a("h2",{attrs:{id:"_1-rail测量模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-rail测量模型"}},[t._v("#")]),t._v(" 1. RAIL测量模型")]),t._v(" "),a("h3",{attrs:{id:"_1-1-rail测量模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-rail测量模型"}},[t._v("#")]),t._v(" 1. 1 RAIL测量模型")]),t._v(" "),a("p",[t._v("RAIL是一个以用户为中心的性能模型，它把用户的体验拆分成几个关键点（例如，tap，scroll，load），并且帮你定义好了每一个的性能指标。")]),t._v(" "),a("p",[t._v("有以下四个方面：")]),t._v(" "),a("p",[a("img",{attrs:{src:s(361),alt:"image.png"}})]),t._v(" "),a("p",[t._v("以下是用户对性能延迟的感知：")]),t._v(" "),a("ul",[a("li",[t._v("小于100毫秒被认为是瞬时的；")]),t._v(" "),a("li",[t._v("100ms到300ms的延迟是可感知的；")]),t._v(" "),a("li",[t._v("一秒钟是用户思想不被打断的极限；")]),t._v(" "),a("li",[t._v("用户希望网站在2秒内加载；")]),t._v(" "),a("li",[t._v("3秒后，40%的访问者会放弃你的网站；")]),t._v(" "),a("li",[t._v("10秒是保持用户注意力的极限。")])]),t._v(" "),a("h6",{attrs:{id:"长任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#长任务"}},[t._v("#")]),t._v(" 长任务")]),t._v(" "),a("ul",[a("li",[t._v("长任务（执行时间大于 50ms）")]),t._v(" "),a("li",[t._v("短任务（执行时间低于 50ms）")])]),t._v(" "),a("h6",{attrs:{id:"response-响应"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#response-响应"}},[t._v("#")]),t._v(" Response 响应")]),t._v(" "),a("ul",[a("li",[t._v("应该尽可能快速的响应用户的操作，事件处理最好在50ms内完成，在100ms以内响应用户输入。")]),t._v(" "),a("li",[t._v("idle task：除了要处理输入事件，浏览器还有其它任务要做，这些任务会占用部分时间，一般情况会花费50ms的时间，输入事件的响应则排在其后。\n"),a("img",{attrs:{src:s(362),alt:"image.png"}})])]),t._v(" "),a("h6",{attrs:{id:"animation-动画"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#animation-动画"}},[t._v("#")]),t._v(" Animation 动画")]),t._v(" "),a("ul",[a("li",[t._v("产生每一帧的时间不要超过10ms，为了保证浏览器60帧，每一帧的时间在16ms左右，但浏览器需要用6ms来渲染每一帧。")]),t._v(" "),a("li",[t._v("旨在视觉上的平滑。用户对帧率变化感知很敏感。")])]),t._v(" "),a("h6",{attrs:{id:"idle-浏览器最大空闲时间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#idle-浏览器最大空闲时间"}},[t._v("#")]),t._v(" Idle 浏览器最大空闲时间")]),t._v(" "),a("ul",[a("li",[t._v("最大化空闲时间，以增大50ms内响应用户输入的几率")]),t._v(" "),a("li",[t._v("用空闲时间来完成一些延后的工作，如先加载页面可见的部分，然后利用空闲时间加载剩余部分，此处可以使用 requestIdleCallback API")]),t._v(" "),a("li",[t._v("在空闲时间内执行的任务尽量控制在50ms以内，如果更长的话，会影响input handle的pending时间")]),t._v(" "),a("li",[t._v("如果用户在空闲时间任务进行时进行交互，必须以此为最高优先级，并暂停空闲时间的任务")])]),t._v(" "),a("h6",{attrs:{id:"load-加载"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#load-加载"}},[t._v("#")]),t._v(" Load 加载")]),t._v(" "),a("ul",[a("li",[t._v("传输内容到页面可交互的时间不超过5秒")]),t._v(" "),a("li",[t._v("对于第二次打开，尽量不超过2秒")])]),t._v(" "),a("h3",{attrs:{id:"_1-2-以用户为中心的性能指标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-以用户为中心的性能指标"}},[t._v("#")]),t._v(" 1.2 以用户为中心的性能指标")]),t._v(" "),a("ul",[a("li",[t._v("First Paint 首次绘制（FP）")]),t._v(" "),a("li",[t._v("First contentful paint 首次内容绘制 (FCP)")]),t._v(" "),a("li",[t._v("Largest contentful paint 最大内容绘制 (LCP)")]),t._v(" "),a("li",[t._v("First input delay 首次输入延迟 (FID)")]),t._v(" "),a("li",[t._v("Time to Interactive 可交互时间 (TTI)")]),t._v(" "),a("li",[t._v("Total blocking time 总阻塞时间 (TBT)")]),t._v(" "),a("li",[t._v("Cumulative layout shift 累积布局偏移 (CLS)")])]),t._v(" "),a("h4",{attrs:{id:"fp-fcp-lcp"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#fp-fcp-lcp"}},[t._v("#")]),t._v(" FP & FCP & LCP")]),t._v(" "),a("ul",[a("li",[t._v("FP: 首次绘制，First Paint，这个指标用于记录页面第一次绘制像素的时间。")]),t._v(" "),a("li",[t._v("FCP: 首次内容绘制，First Contentful Paint，这个指标用于记录页面首次绘制文本、图片、非空白 Canvas 或 SVG 的时间。")]),t._v(" "),a("li",[t._v("LCP：最大内容绘制时间，用于记录视窗内最大的元素绘制的时间\n"),a("ul",[a("li",[t._v("持续更新：该时间会随着页面渲染变化而变化，因为页面中的最大元素在渲染过程中可能会发生改变，另外该指标会在用户第一次交互后停止记录。")]),t._v(" "),a("li",[t._v("例子：当页面出现骨架屏或者 Loading 动画时 FCP 其实已经被记录下来了，但是此时用户希望看到的内容其实并未呈现，我们更想知道的是页面主要的内容是何时呈现出来的。")])])])]),t._v(" "),a("h4",{attrs:{id:"tti-fid"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tti-fid"}},[t._v("#")]),t._v(" TTI & FID")]),t._v(" "),a("ul",[a("li",[t._v("TTI（Time to Interactive）：首次可交互时间\n"),a("ul",[a("li",[t._v("从 FCP 指标后开始计算")]),t._v(" "),a("li",[t._v("持续 5 秒内无长任务（执行时间超过 50 ms）且无两个以上正在进行中的 GET 请求")]),t._v(" "),a("li",[t._v("往前回溯至 5 秒前的最后一个长任务结束的时间\n"),a("img",{attrs:{src:s(363),alt:"image.png"}})])])]),t._v(" "),a("li",[t._v("FID（First Input Delay）：首次输入延迟，记录在 FCP 和 TTI 之间用户首次与页面交互时响应的延迟。")])]),t._v(" "),a("h4",{attrs:{id:"tbt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tbt"}},[t._v("#")]),t._v(" TBT")]),t._v(" "),a("ul",[a("li",[t._v("TBT（Total Blocking Time）：阻塞总时间，记录在 FCP 到 TTI 之间所有长任务的阻塞时间总和。")]),t._v(" "),a("li",[t._v("例子：如果说在 FCP 到 TTI 之间页面总共执行了以下长任务（执行时间大于 50ms）及短任务（执行时间低于 50ms），那么每个长任务的阻塞时间就等于它所执行的总时间减去 50ms\n"),a("img",{attrs:{src:s(364),alt:"image.png"}})])]),t._v(" "),a("p",[a("img",{attrs:{src:s(365),alt:"image.png"}})]),t._v(" "),a("h4",{attrs:{id:"cls"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cls"}},[t._v("#")]),t._v(" CLS")]),t._v(" "),a("p",[t._v("累计位移偏移，CLS（Cumulative Layout Shift），记录了页面上非预期的位移波动。计算方式为：位移影响的面积 * 位移距离。")]),t._v(" "),a("h2",{attrs:{id:"_2-web-vitals"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-web-vitals"}},[t._v("#")]),t._v(" 2. "),a("a",{attrs:{href:"https://web.dev/vitals/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Web Vitals"),a("OutboundLink")],1)]),t._v(" "),a("p",[t._v("Google 在20年五月提出了网站用户体验的三大核心指标")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("LCP")]),t._v(" （Largest Contentful Paint）：最大内容绘制时间，用来衡量加载体验，谷歌要求LCP最好在页面首次开始加载后的2.5秒内发生；")]),t._v(" "),a("li",[a("strong",[t._v("FID")]),t._v(" （First Input Delay）：首次输入延迟时间，用于衡量页面交互性，谷歌要求页面的FID最好小于100毫秒；")]),t._v(" "),a("li",[a("strong",[t._v("CLS")]),t._v(" （Cumulative Layout Shift）：累计布局位移，用于衡量视觉稳定性，谷歌要求页面的CLS最好保持小于0.1。\n"),a("img",{attrs:{src:s(366),alt:"image.png"}})])]),t._v(" "),a("h2",{attrs:{id:"_3-其他常用指标"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-其他常用指标"}},[t._v("#")]),t._v(" 3. 其他常用指标")]),t._v(" "),a("ul",[a("li",[t._v("白屏时间：从浏览器输入地址并回车后到页面开始有内容的时间；")]),t._v(" "),a("li",[t._v("首屏时间：从浏览器输入地址并回车后到首屏内容渲染完毕的时间；")]),t._v(" "),a("li",[t._v("用户可操作时间节点：domready触发节点，点击事件有反应；")]),t._v(" "),a("li",[t._v("总下载时间：window.onload的触发节点。\n"),a("img",{attrs:{src:s(367),alt:"image.png"}})])]),t._v(" "),a("h1",{attrs:{id:"性能指标的测量与计算"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#性能指标的测量与计算"}},[t._v("#")]),t._v(" 性能指标的测量与计算")]),t._v(" "),a("h2",{attrs:{id:"web-vitals"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#web-vitals"}},[t._v("#")]),t._v(" web vitals")]),t._v(" "),a("p",[t._v("测量所有核心 Web 指标，最简单的方法是使用web-vitals JavaScript 库，这是一个围绕底层网页 API 的小型的、生产就绪的封装器，通过准确匹配每项指标在上方列出的所有 Google 工具中的报告方式来进行指标测量。")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("import {getCLS, getFID, getLCP} from 'web-vitals';\n\nfunction sendToAnalytics(metric) {\n  const body = JSON.stringify(metric);\n  // Use `navigator.sendBeacon()` if available, falling back to `fetch()`.\n  (navigator.sendBeacon && navigator.sendBeacon('/analytics', body)) ||\n      fetch('/analytics', {body, method: 'POST', keepalive: true});\n}\n\ngetCLS(sendToAnalytics);\ngetFID(sendToAnalytics);\ngetLCP(sendToAnalytics);\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br")])]),a("h2",{attrs:{id:"performance-api"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#performance-api"}},[t._v("#")]),t._v(" Performance API")]),t._v(" "),a("blockquote",[a("p",[t._v("Performance API 是前端性能监控中常用的API\nPerformance API最主要的作用就是支持应用程序中客户端的延时测量。")])]),t._v(" "),a("ul",[a("li",[t._v("常用API")])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("performance.getEntries()\nperformance.getEntriesByName() \nperformance.getEntriesByType() \nperformance.mark() \nperformance.clearMarks() \nperformance.measure() \nperformance.clearMeasures() \nperformance.now()\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br")])]),a("h5",{attrs:{id:"performance-api的时间测量与date对象的时间定义的区别"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#performance-api的时间测量与date对象的时间定义的区别"}},[t._v("#")]),t._v(" Performance API的时间测量与Date对象的时间定义的区别")]),t._v(" "),a("ol",[a("li",[t._v("精度不同")])]),t._v(" "),a("ul",[a("li",[t._v("Performance API 是高采样率的，因为其精确度可达千分之一毫秒（受硬件或软件限制）")]),t._v(" "),a("li",[t._v("Date 对象则基于 Unix Time Stamp，即自1970年1月1日（UTC）起经过的毫秒数")])]),t._v(" "),a("ol",{attrs:{start:"2"}},[a("li",[t._v("Performance API 支持单调时钟")])]),t._v(" "),a("ul",[a("li",[t._v("使用 Date.now() 的差值并非绝对精确，因为计算时间时受系统限制（可能阻塞），有可能会出现 Time1 - Time2 是负值的情况")]),t._v(" "),a("li",[t._v("performance.now() 方法返回一个"),a("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/DOMHighResTimeStamp",target:"_blank",rel:"noopener noreferrer"}},[t._v("DOMHighResTimeStamp"),a("OutboundLink")],1),t._v(",其时间是以恒定速率递增的，不受系统时间的影响（系统时间可被人为或软件调整）")])]),t._v(" "),a("h5",{attrs:{id:"performance-entry"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#performance-entry"}},[t._v("#")]),t._v(" Performance Entry")]),t._v(" "),a("ul",[a("li",[t._v("PerformanceEntry 对象代表了 performance 时间列表中的单个 metric 数据.")]),t._v(" "),a("li",[t._v("Performance entries 在资源加载的时候，也会被动生成（例如图片、script、css等资源加载）")]),t._v(" "),a("li",[t._v("注意：Entries初始150个限制，可通过以下两个API修改\n"),a("ul",[a("li",[t._v("修改上限：setResourceTimingBufferSize(your_number);")]),t._v(" "),a("li",[t._v("清除当前保存的Entries：clearResourceTimings()")])])])]),t._v(" "),a("h5",{attrs:{id:"获取entry"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#获取entry"}},[t._v("#")]),t._v(" 获取Entry")]),t._v(" "),a("ul",[a("li",[t._v("浏览器获取网页时，会对网页中每一个对象（脚本文件、样式表、图片文件等等）发出一个HTTP请求。performance.getEntries方法以数组形式，返回这些请求的时间统计信息，有多少个请求，返回数组就会有多少个成员。")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// entry获取")]),t._v("\nperformance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntries")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nperformance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntriesByType")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nperformance"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("getEntriesByName")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("name"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" type"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// getEntriesByType() 方法返回给定类型的 PerformanceEntry 列表")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// performance.getEntriesByType("resource")方法为每个请求的资源获取一个资源定时对象数组')]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("h5",{attrs:{id:"entry属性与计算"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#entry属性与计算"}},[t._v("#")]),t._v(" Entry属性与计算")]),t._v(" "),a("p",[a("img",{attrs:{src:s(368),alt:"image.png"}})]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("connectEnd：连接结束时间\nconnectStart：连接开始时间\ndecodedBodySize：解码的主体大小\ndomComplete：dom 渲染完成时间\ndomContentLoadedEventEnd：dom 内容加载事件结束时间\ndomContentLoadedEventStart：dom 内容加载事件开始时间\ndomInteractive：dom 交互时间\ndomainLookupEnd：域查找结束时间\ndomainLookupStart：域查找开始时间\nduration：事件耗时\nencodedBodySize：编码主体大小\nentryType：资源输入类型\nfetchStart：获取资源开始时间\ninitiatorType：发起人类型\nloadEventEnd：加载事件结束时间\nloadEventStart：加载事件开始时间\nname：这里一般就是当前请求的 url 的地址\nnextHopProtocol：下一个跳转协议\nredirectCount：重定向次数\nredirectEnd：重定向开始时间，如果没有重定向，值为0\nredirectStart：重定向结束时间，如果没有重定向，值为0\nrequestStart：请求开始时间\nresponseEnd：响应结束时间\nresponseStart：响应开始时间\nsecureConnectionStart：安全连接开始时间\nserverTiming：服务器时间\nstartTime：开始时间\ntransferSize：传递大小\ntype：该事件的类型\nunloadEventEnd：卸载事件结束时间\nunloadEventStart：卸载事件开始时间\nworkerStart：worker 开始时间\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br"),a("span",{staticClass:"line-number"},[t._v("32")]),a("br")])]),a("p",[t._v("性能计算公式")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("DNS查询耗时 = domainLookupEnd - domainLookupStart\nTCP链接耗时 = connectEnd - connectStart\nrequest请求耗时 = responseEnd - responseStart\n解析dom树耗时 = domComplete - domInteractive\n白屏时间 = domloading - fetchStart\ndomready可操作时间 = domContentLoadedEventEnd - fetchStart\nonload总下载时间 = loadEventEnd - fetchStart\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("h4",{attrs:{id:"实践-获取未裁剪大图片"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实践-获取未裁剪大图片"}},[t._v("#")]),t._v(" 实践：获取未裁剪大图片")]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("export const getBigImgEntries = (oldUrl) => {\n    const entryList = window.performance.getEntriesByType('resource');\n    let bigImgList = entryList.filter(entry => {\n        // entry.initiatorType === 'img'\n        // 筛选未配置裁剪参数的图片，即为未处理的大图\n        // 配置了裁剪参数的，则比较图片尺寸，与imgdom尺寸是否误差较大\n        // const imgdom = document.querySelector('img[src=\"'+ imgEntry.name +'\"]') \n    });\n    if (!bigImgList.length) return null;\n    return bigImgList;\n}\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("h1",{attrs:{id:"数据采集"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据采集"}},[t._v("#")]),t._v(" 数据采集")]),t._v(" "),a("h2",{attrs:{id:"用户数据采集"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#用户数据采集"}},[t._v("#")]),t._v(" 用户数据采集")]),t._v(" "),a("p",[a("img",{attrs:{src:s(369),alt:"image.png"}})]),t._v(" "),a("h4",{attrs:{id:"sdk采集"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sdk采集"}},[t._v("#")]),t._v(" sdk采集")]),t._v(" "),a("ul",[a("li",[t._v("使用 puzzle 接入 SDK 进行监控，可覆盖前期版本。适用于通用数据采集，但部分特殊场景监控项不适用。")]),t._v(" "),a("li",[t._v("SDK 开发流程\n"),a("img",{attrs:{src:s(370),alt:"image.png"}})]),t._v(" "),a("li",[t._v("SDK开发注意点\n"),a("ul",[a("li",[t._v("版本控制\n"),a("ul",[a("li",[t._v("采样率\n"),a("ul",[a("li",[t._v("每个监控项，PUZZLE分别配置采样率")])])]),t._v(" "),a("li",[t._v("SDK静态文件\n"),a("ul",[a("li",[t._v("静态部署平台部署生成")]),t._v(" "),a("li",[t._v("缓存：SDK版本升级规则")])])]),t._v(" "),a("li",[t._v("数据存储隔离\n"),a("ul",[a("li",[t._v("测试 & 生产环境 数据隔离")]),t._v(" "),a("li",[t._v("上报字段区分，测试‘xxxx–beta")])])])])]),t._v(" "),a("li",[t._v("上报数据，可聚合字段，")]),t._v(" "),a("li",[t._v("无效数据过滤，保证数据准确性，可进行预处理")]),t._v(" "),a("li",[t._v("避免影响应用性能")])])]),t._v(" "),a("li",[t._v("性能以外的指标\n"),a("ul",[a("li",[t._v("版本分布")]),t._v(" "),a("li",[t._v("位置信息")]),t._v(" "),a("li",[t._v("设备信息")]),t._v(" "),a("li",[t._v("接口监控")]),t._v(" "),a("li",[t._v("PV/UV")])])])]),t._v(" "),a("h4",{attrs:{id:"自定义埋点上报"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自定义埋点上报"}},[t._v("#")]),t._v(" 自定义埋点上报")]),t._v(" "),a("ul",[a("li",[t._v("无法覆盖前期版本，但成本低，操作简单，场景灵活")])]),t._v(" "),a("h2",{attrs:{id:"常用实验室评测工具"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用实验室评测工具"}},[t._v("#")]),t._v(" 常用实验室评测工具")]),t._v(" "),a("ul",[a("li",[a("ol",[a("li",[a("a",{attrs:{href:"https://webpagetest.org/easy",target:"_blank",rel:"noopener noreferrer"}},[t._v("WebPage Test"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("ol",{attrs:{start:"2"}},[a("li",[a("a",{attrs:{href:"https://github.com/GoogleChrome/lighthouse",target:"_blank",rel:"noopener noreferrer"}},[t._v("LightHouse"),a("OutboundLink")],1),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://chrome.google.com/webstore/detail/lighthouse/blipmdconlkpinefehnmjammfjpmpbjk",target:"_blank",rel:"noopener noreferrer"}},[t._v("插件"),a("OutboundLink")],1)]),t._v(" "),a("li",[t._v("使用npm包lighthouse")])])])]),t._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[t._v("npm install -g lighthouse\nlighthouse http://www.baidu.com/\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])])]),t._v(" "),a("li",[a("ol",{attrs:{start:"3"}},[a("li",[a("a",{attrs:{href:"https://developers.google.com/web/tools/chrome-devtools",target:"_blank",rel:"noopener noreferrer"}},[t._v("Chrome DevTools"),a("OutboundLink")],1)])])]),t._v(" "),a("li",[a("ol",{attrs:{start:"4"}},[a("li",[a("RouterLink",{attrs:{to:"/skill/web/puppeteer.html"}},[t._v("Puppeteer")])],1)])])]),t._v(" "),a("h1",{attrs:{id:"数据可视化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据可视化"}},[t._v("#")]),t._v(" 数据可视化")]),t._v(" "),a("ul",[a("li",[t._v("图表化")]),t._v(" "),a("li",[t._v("多维度：时间、版本、比例")]),t._v(" "),a("li",[t._v("对照分析")]),t._v(" "),a("li",[t._v("自定义埋点自动生成图标")])]),t._v(" "),a("h1",{attrs:{id:"数据分析与用户反馈"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据分析与用户反馈"}},[t._v("#")]),t._v(" 数据分析与用户反馈")]),t._v(" "),a("ul",[a("li",[t._v("形成评分体系")]),t._v(" "),a("li",[t._v("以比例和分值进行具体评判")]),t._v(" "),a("li",[t._v("自动定期推送用户")]),t._v(" "),a("li",[t._v("工程质量治理")])])])}),[],!1,null,null,null);a.default=n.exports}}]);