(window.webpackJsonp=window.webpackJsonp||[]).push([[32],{354:function(e,r,n){e.exports=n.p+"assets/img/1.d967fe2d.png"},443:function(e,r,n){"use strict";n.r(r);var a=n(14),s=Object(a.a)({},(function(){var e=this,r=e._self._c;return r("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[r("h1",{attrs:{id:"performance-entry"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#performance-entry"}},[e._v("#")]),e._v(" performance Entry")]),e._v(" "),r("blockquote",[r("p",[e._v("Performance API 是前端性能监控中常用的API，下面对Performance API中的Performance Entry相关要点做一个梳理介绍")])]),e._v(" "),r("h2",{attrs:{id:"performance-api"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#performance-api"}},[e._v("#")]),e._v(" Performance API")]),e._v(" "),r("p",[e._v("Performance API最主要的作用就是支持应用程序中客户端的延时测量。")]),e._v(" "),r("p",[e._v("那么Performance API的时间测量与Date对象的时间定义有什么区别呢？")]),e._v(" "),r("ol",[r("li",[e._v("精度不同")])]),e._v(" "),r("ul",[r("li",[e._v("Performance API 是高采样率的，因为其精确度可达千分之一毫秒（受硬件或软件限制）")]),e._v(" "),r("li",[e._v("Date 对象则基于 Unix Time Stamp，即自1970年1月1日（UTC）起经过的毫秒数")])]),e._v(" "),r("ol",{attrs:{start:"2"}},[r("li",[e._v("Performance API 支持单调时钟")])]),e._v(" "),r("ul",[r("li",[e._v("使用 Date.now() 的差值并非绝对精确，因为计算时间时受系统限制（可能阻塞），有可能会出现 Time1 - Time2 是负值的情况")]),e._v(" "),r("li",[e._v("performance.now() 方法返回一个"),r("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/DOMHighResTimeStamp",target:"_blank",rel:"noopener noreferrer"}},[e._v("DOMHighResTimeStamp"),r("OutboundLink")],1),e._v(",其时间是以恒定速率递增的，不受系统时间的影响（系统时间可被人为或软件调整）")])]),e._v(" "),r("h2",{attrs:{id:"performance-entry-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#performance-entry-2"}},[e._v("#")]),e._v(" Performance Entry")]),e._v(" "),r("h3",{attrs:{id:"介绍"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[e._v("#")]),e._v(" 介绍")]),e._v(" "),r("ul",[r("li",[e._v("PerformanceEntry 对象代表了 performance 时间列表中的单个 metric 数据.")]),e._v(" "),r("li",[e._v("每一个性能条目都可以在应用运行过程中通过手动构建 mark （en-US）或者 measure （en-US）（例如调用mark()方法）生成。")]),e._v(" "),r("li",[e._v("Performance entries 在资源加载的时候，也会被动生成（例如图片、script、css等资源加载）")]),e._v(" "),r("li",[e._v("Entries初始150个限制，可通过以下两个API修改\n"),r("ul",[r("li",[e._v("修改上限：setResourceTimingBufferSize(your_number);")]),e._v(" "),r("li",[e._v("清除当前保存的Entries：clearResourceTimings()")])])])]),e._v(" "),r("h3",{attrs:{id:"属性"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#属性"}},[e._v("#")]),e._v(" 属性")]),e._v(" "),r("ul",[r("li",[e._v("resource entry 结构如下")])]),e._v(" "),r("p",[r("img",{attrs:{src:n(354),alt:"image.png"}})]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v("connectEnd：连接结束时间\nconnectStart：连接开始时间\ndecodedBodySize：解码的主体大小\ndomComplete：dom 渲染完成时间\ndomContentLoadedEventEnd：dom 内容加载事件结束时间\ndomContentLoadedEventStart：dom 内容加载事件开始时间\ndomInteractive：dom 交互时间\ndomainLookupEnd：域查找结束时间\ndomainLookupStart：域查找开始时间\nduration：事件耗时\nencodedBodySize：编码主体大小\nentryType：资源输入类型\nfetchStart：获取资源开始时间\ninitiatorType：发起人类型\nloadEventEnd：加载事件结束时间\nloadEventStart：加载事件开始时间\nname：这里一般就是当前请求的 url 的地址\nnextHopProtocol：下一个跳转协议\nredirectCount：重定向次数\nredirectEnd：重定向开始时间，如果没有重定向，值为0\nredirectStart：重定向结束时间，如果没有重定向，值为0\nrequestStart：请求开始时间\nresponseEnd：响应结束时间\nresponseStart：响应开始时间\nsecureConnectionStart：安全连接开始时间\nserverTiming：服务器时间\nstartTime：开始时间\ntransferSize：传递大小\ntype：该事件的类型\nunloadEventEnd：卸载事件结束时间\nunloadEventStart：卸载事件开始时间\nworkerStart：worker 开始时间\n")])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br"),r("span",{staticClass:"line-number"},[e._v("4")]),r("br"),r("span",{staticClass:"line-number"},[e._v("5")]),r("br"),r("span",{staticClass:"line-number"},[e._v("6")]),r("br"),r("span",{staticClass:"line-number"},[e._v("7")]),r("br"),r("span",{staticClass:"line-number"},[e._v("8")]),r("br"),r("span",{staticClass:"line-number"},[e._v("9")]),r("br"),r("span",{staticClass:"line-number"},[e._v("10")]),r("br"),r("span",{staticClass:"line-number"},[e._v("11")]),r("br"),r("span",{staticClass:"line-number"},[e._v("12")]),r("br"),r("span",{staticClass:"line-number"},[e._v("13")]),r("br"),r("span",{staticClass:"line-number"},[e._v("14")]),r("br"),r("span",{staticClass:"line-number"},[e._v("15")]),r("br"),r("span",{staticClass:"line-number"},[e._v("16")]),r("br"),r("span",{staticClass:"line-number"},[e._v("17")]),r("br"),r("span",{staticClass:"line-number"},[e._v("18")]),r("br"),r("span",{staticClass:"line-number"},[e._v("19")]),r("br"),r("span",{staticClass:"line-number"},[e._v("20")]),r("br"),r("span",{staticClass:"line-number"},[e._v("21")]),r("br"),r("span",{staticClass:"line-number"},[e._v("22")]),r("br"),r("span",{staticClass:"line-number"},[e._v("23")]),r("br"),r("span",{staticClass:"line-number"},[e._v("24")]),r("br"),r("span",{staticClass:"line-number"},[e._v("25")]),r("br"),r("span",{staticClass:"line-number"},[e._v("26")]),r("br"),r("span",{staticClass:"line-number"},[e._v("27")]),r("br"),r("span",{staticClass:"line-number"},[e._v("28")]),r("br"),r("span",{staticClass:"line-number"},[e._v("29")]),r("br"),r("span",{staticClass:"line-number"},[e._v("30")]),r("br"),r("span",{staticClass:"line-number"},[e._v("31")]),r("br"),r("span",{staticClass:"line-number"},[e._v("32")]),r("br")])]),r("h3",{attrs:{id:"获取entry的方法"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#获取entry的方法"}},[e._v("#")]),e._v(" 获取Entry的方法")]),e._v(" "),r("h4",{attrs:{id:"performance-getentries"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#performance-getentries"}},[e._v("#")]),e._v(" performance.getEntries()")]),e._v(" "),r("ul",[r("li",[r("p",[e._v("浏览器获取网页时，会对网页中每一个对象（脚本文件、样式表、图片文件等等）发出一个HTTP请求。performance.getEntries方法以数组形式，返回这些请求的时间统计信息，有多少个请求，返回数组就会有多少个成员。")])]),e._v(" "),r("li",[r("p",[e._v("transferSize: 资源大小，支持浏览器：Chrome 53 以上，可能出现为0的情况")]),e._v(" "),r("ul",[r("li",[e._v("原因：如果从本地缓存中获取资源，或者它是跨域资源，则此属性返回零。")]),e._v(" "),r("li",[e._v("启用CORS时，除非服务器的访问策略允许共享这些值，否则许多这些值将返回零。这要求服务器提供资源以发送Timing-Allow-Origin HTTP响应标头，并提供一个值，该值指定允许获得受限时间戳值的一个或多个起源。")]),e._v(" "),r("li",[e._v("从网页本身以外的其他域加载资源时，默认情况下返回为0的属性：redirectStart，redirectEnd，domainLookupStart，domainLookupEnd，connectStart，connectEnd，secureConnectionStart，requestStart和responseStart。")])])])]),e._v(" "),r("h4",{attrs:{id:"performance-getentriesbytype-type"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#performance-getentriesbytype-type"}},[e._v("#")]),e._v(" performance.getEntriesByType(type)")]),e._v(" "),r("ul",[r("li",[e._v("getEntriesByType()  方法返回给定类型的 PerformanceEntry 列表")]),e._v(" "),r("li",[e._v('performance.getEntriesByType("resource")方法为每个请求的资源获取一个资源定时对象数组')]),e._v(" "),r("li",[e._v("entryType")])]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('- "mark"\tPerformanceMark\tUser Timing\t\n- "measure"\tPerformanceMeasure\tUser Timing\t\n- "navigation"\tPerformanceNavigationTiming\tNavigation Timing 2\twork in progress\n- "frame"\tPerformanceFrameTiming\tFrame Timing\twork in progress\n- "resource"\tPerformanceResourceTiming\tResource Timing\twork in progress\n- "server"\tPerformanceServerTiming\tServer Timing\twork in progress\n')])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br"),r("span",{staticClass:"line-number"},[e._v("4")]),r("br"),r("span",{staticClass:"line-number"},[e._v("5")]),r("br"),r("span",{staticClass:"line-number"},[e._v("6")]),r("br")])]),r("h4",{attrs:{id:"performance-getentriesbyname-name-type"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#performance-getentriesbyname-name-type"}},[e._v("#")]),e._v(" performance.getEntriesByName(name, type)")]),e._v(" "),r("ul",[r("li",[e._v("getEntriesByName()方法返回一个给定名称和name和type属性的PerformanceEntry对象数组")])]),e._v(" "),r("h3",{attrs:{id:"标记与测算"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#标记与测算"}},[e._v("#")]),e._v(" 标记与测算")]),e._v(" "),r("h4",{attrs:{id:"performance-mark-name"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#performance-mark-name"}},[e._v("#")]),e._v(" performance.mark(name)")]),e._v(" "),r("p",[e._v("根据给出 name 值，在浏览器的性能输入缓冲区中创建一个相关的时间戳")]),e._v(" "),r("h4",{attrs:{id:"performance-measure-name-startmark-endmark"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#performance-measure-name-startmark-endmark"}},[e._v("#")]),e._v(" performance.measure(name, startMark, endMark)")]),e._v(" "),r("p",[e._v("这里接收三个参数：")]),e._v(" "),r("p",[e._v("name：测量的名字\nstartMark：测量的开始标志名字（也可以是 PerformanceTiming 属性的名称）\nendMark：测量的结束标志名字（也可以是 PerformanceTiming 属性的名称）")]),e._v(" "),r("blockquote",[r("p",[e._v("一般来说，performance.mark, performance.measure组合使用，例子如下")])]),e._v(" "),r("div",{staticClass:"language- line-numbers-mode"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[e._v('// 标记开始\nperformance.mark("myTimestart");\n// ...\ndosometing();\n// 标记结束\nperformance.mark("myTimeend");\n\n// 标记开始点和结束点之间的时间戳\nperformance.measure(\n    "myTime",\n    "myTimestart",\n    "myTimeend"\n);\n\n// 获取所有名称为myTime的measures\nvar measures = performance.getEntriesByName("myTime");\nvar measure = measures[0];\nconsole.log("myTime milliseconds:", measure.duration);\n\n// 清除标记\nperformance.clearMarks();\nperformance.clearMeasures();\n')])]),e._v(" "),r("div",{staticClass:"line-numbers-wrapper"},[r("span",{staticClass:"line-number"},[e._v("1")]),r("br"),r("span",{staticClass:"line-number"},[e._v("2")]),r("br"),r("span",{staticClass:"line-number"},[e._v("3")]),r("br"),r("span",{staticClass:"line-number"},[e._v("4")]),r("br"),r("span",{staticClass:"line-number"},[e._v("5")]),r("br"),r("span",{staticClass:"line-number"},[e._v("6")]),r("br"),r("span",{staticClass:"line-number"},[e._v("7")]),r("br"),r("span",{staticClass:"line-number"},[e._v("8")]),r("br"),r("span",{staticClass:"line-number"},[e._v("9")]),r("br"),r("span",{staticClass:"line-number"},[e._v("10")]),r("br"),r("span",{staticClass:"line-number"},[e._v("11")]),r("br"),r("span",{staticClass:"line-number"},[e._v("12")]),r("br"),r("span",{staticClass:"line-number"},[e._v("13")]),r("br"),r("span",{staticClass:"line-number"},[e._v("14")]),r("br"),r("span",{staticClass:"line-number"},[e._v("15")]),r("br"),r("span",{staticClass:"line-number"},[e._v("16")]),r("br"),r("span",{staticClass:"line-number"},[e._v("17")]),r("br"),r("span",{staticClass:"line-number"},[e._v("18")]),r("br"),r("span",{staticClass:"line-number"},[e._v("19")]),r("br"),r("span",{staticClass:"line-number"},[e._v("20")]),r("br"),r("span",{staticClass:"line-number"},[e._v("21")]),r("br"),r("span",{staticClass:"line-number"},[e._v("22")]),r("br")])])])}),[],!1,null,null,null);r.default=s.exports}}]);