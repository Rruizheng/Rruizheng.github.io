(window.webpackJsonp=window.webpackJsonp||[]).push([[79],{432:function(s,t,e){"use strict";e.r(t);var n=e(14),a=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"页面加载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#页面加载"}},[s._v("#")]),s._v(" 页面加载")]),s._v(" "),t("ol",[t("li",[s._v("URL解析")]),s._v(" "),t("li",[s._v("DNS解析")]),s._v(" "),t("li",[s._v("TCP连接")]),s._v(" "),t("li",[s._v("HTTP请求发送返回")]),s._v(" "),t("li",[s._v("资源解析、HTML/JS/CSS")]),s._v(" "),t("li",[s._v("页面渲染")])]),s._v(" "),t("h3",{attrs:{id:"_1-url解析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-url解析"}},[s._v("#")]),s._v(" 1. URL解析")]),s._v(" "),t("ul",[t("li",[s._v("地址解析，判断你输入的是url还是搜索词")]),s._v(" "),t("li",[s._v("HSTS：强制https访问。首次无效，没有下发hsts不行。防止ssl攻击")]),s._v(" "),t("li",[s._v("其他操作：浏览器还会进行一些额外的操作，比如安全检查、访问限制（之前国产浏览器限制 996.icu）")]),s._v(" "),t("li",[s._v("缓存查询\n"),t("ul",[t("li",[s._v("强制缓存，判断是否过期。Expires和Cache-Control\n"),t("ul",[t("li",[s._v("Expires和Cache-Control的区别： Expires过期时间。Cache-Control缓存时间。Cache-Control优先级更高。https://www.cnblogs.com/lguow/p/10620940.html")])])]),s._v(" "),t("li",[s._v("协商缓存，携带标记发送请求。if-Modified-Since和If-None-Match。Last-Modified和Etag\n"),t("ul",[t("li",[s._v("服务器设置 Last-Modifed 和 Etag 的值，浏览器请求会携带这两个头，在请求头中，会有 If-Modified-since: Last-Modifed值 和 If-None-Match: Etag值。")])])])])]),s._v(" "),t("li",[s._v("缓存资料：https://mp.weixin.qq.com/s/43pa04szJ2zU_IyVP4LraQ")])]),s._v(" "),t("h3",{attrs:{id:"_2-dns查询-域名转ip"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-dns查询-域名转ip"}},[s._v("#")]),s._v(" 2.DNS查询，域名转ip")]),s._v(" "),t("ul",[t("li",[s._v("顺序：浏览器-操作系统-路由器缓存-ISP DNS缓存-根域名服务器")]),s._v(" "),t("li",[s._v("递归方式")]),s._v(" "),t("li",[s._v("迭代方式：本地DNS服务器到根域名服务器查询的方式")]),s._v(" "),t("li",[s._v("DNS劫持：通过攻击域名解析服务器（DNS），或伪造域名解析服务器（DNS），返回错误的ip")]),s._v(" "),t("li",[s._v("前端dns-prefetch优化：https://blog.csdn.net/qq_35432904/article/details/83988726")])]),s._v(" "),t("p",[s._v("DNS的优化与应用")]),s._v(" "),t("p",[s._v("DNS缓存 DNS存在着多级缓存，从离浏览器的距离排序的话，有以下几种: 浏览器缓存，系统缓存，路由器缓存，IPS服务器缓存，根域名服务器缓存，顶级域名服务器缓存，主域名服务器缓存。")]),s._v(" "),t("p",[s._v("DNS负载均衡(DNS重定向) DNS负载均衡技术的实现原理是在DNS服务器中为同一个主机名配置多个IP地址，在应答DNS查询时， DNS服务器对每个查询将以DNS文件中主机记录的IP地址按顺序返回不同的解析结果，将客户端的访问 引导到不同的机器上去，使得不同的客户端访问不同的服务器，从而达到负载均衡的目的。")]),s._v(" "),t("p",[s._v("大家耳熟能详的CDN(Content Delivery Network)就是利用DNS的重定向技术，DNS服务器会返回一个跟\n用户最接近的点的IP地址给用户，CDN节点的服务器负责响应用户的请求，提供所需的内容。")]),s._v(" "),t("p",[s._v("dns-prefetch DNS Prefetch 是一种 DNS 预解析技术。当你浏览网页时，浏览器会在加载网页时对网页中的域名进行解析缓存，这样在你单击当前网页中的连接时就无需进行 DNS 的解析，减少用户等待时间，提高用户体验。")]),s._v(" "),t("p",[s._v("作者：williamife\n链接：https://juejin.cn/post/6844903784229896199\n来源：稀土掘金\n著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。")]),s._v(" "),t("h3",{attrs:{id:"_3-tcp连接"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-tcp连接"}},[s._v("#")]),s._v(" 3.TCP连接")]),s._v(" "),t("p",[s._v("四层")]),s._v(" "),t("ul",[t("li",[s._v("应用层：发送Http数据")]),s._v(" "),t("li",[s._v("传输层：TCP首部、HttP数据。TCP/IP三次握手")]),s._v(" "),t("li",[s._v("网络层：TCP+HTTP+IP")]),s._v(" "),t("li",[s._v("链路层：TCP+HTTP+IP+以太网")])]),s._v(" "),t("h3",{attrs:{id:"_4-服务器处理请求。返回数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-服务器处理请求。返回数据"}},[s._v("#")]),s._v(" 4.服务器处理请求。返回数据")]),s._v(" "),t("ul",[t("li",[s._v("HTTPD")]),s._v(" "),t("li",[s._v("请求处理")]),s._v(" "),t("li",[s._v("重定向：根据服务器配置处理")]),s._v(" "),t("li",[s._v("URL重写：文件存在，返回。否则，请求会重写到一个REST风格的URL上")])]),s._v(" "),t("h3",{attrs:{id:"_5-浏览器接受响应"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_5-浏览器接受响应"}},[s._v("#")]),s._v(" 5.浏览器接受响应")]),s._v(" "),t("ul",[t("li",[s._v("分析资源")]),s._v(" "),t("li",[s._v("查看ResponseHeader，根据不同状态码做不同的事")]),s._v(" "),t("li",[s._v("资源如果压缩了，要先进行解压")]),s._v(" "),t("li",[s._v("对响应资源做缓存")]),s._v(" "),t("li",[s._v("根据响应资源里的MIME类型去解析响应内容\n"),t("ul",[t("li",[s._v("我们并不知道其响应的数据是什么类型的，为了区分这些资源类型，就需要用到 MIME 了。HTTP 会为每一个通过 web 传输的对象添加上 MIME 类型的数据格式标签。浏览器在读取到对应的信息后，会调用相应的程序去处理它，任何得到我们想要的结果。")]),s._v(" "),t("li",[s._v("Accept和Content-Type")])])])]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("    text/html：HTML 格式的文本文档\n\n　　text/plain：普通的 ASCII 文本文档\n\n　　image/jpeg：JPEG格式的图片\n\n　　image/gif：GIF格式的图片\n\n　　video/quicktime：Apple 的 QuickTime 电影\n\n　　application/vnd.ms-powerpoint：微软的       powerpoint文件\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br")])]),t("h3",{attrs:{id:"_6-页面渲染"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_6-页面渲染"}},[s._v("#")]),s._v(" 6.页面渲染")]),s._v(" "),t("p",[s._v("-浏览器内核\nTrident、Blink、WebKit、Gecko")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("JS")])]),s._v(" "),t("li",[t("p",[s._v("HTML - DOM Tree：解码-预解析-符号化-构建树。DOMContentLoaded事件")])]),s._v(" "),t("li",[t("p",[s._v("CSS - CSS StyleSheet Tree")])]),s._v(" "),t("li",[t("p",[s._v("Render Tree: 注意：渲染树会忽略那些不需要渲染的节点，比如设置了display:none的节点。")])]),s._v(" "),t("li",[t("p",[s._v("RePaint(重绘)")])]),s._v(" "),t("li",[t("p",[s._v("Reflow(回流)")])]),s._v(" "),t("li",[t("p",[s._v("显示")])]),s._v(" "),t("li",[t("p",[s._v("CSS\nCSS 匹配规则")])])]),s._v(" "),t("p",[s._v("在匹配一个节点对应的 CSS 规则时，是按照从右到左的顺序的，例如：div p { font-size :14px }会先寻找所有的p标签然后判断它的父元素是否为div。")]),s._v(" "),t("h4",{attrs:{id:"渲染阻塞"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#渲染阻塞"}},[s._v("#")]),s._v(" 渲染阻塞")]),s._v(" "),t("ul",[t("li",[s._v("当遇到一个script标签时，DOM 构建会被暂停，直至脚本完成执行，然后继续构建 DOM 树。")]),s._v(" "),t("li",[s._v("但如果 JS 依赖 CSS 样式，而它还没有被下载和构建时，浏览器就会延迟脚本执行，直至 CSS Rules 被构建。\n所有我们知道：\nCSS 会阻塞 JS 执行\nJS 会阻塞后面的 DOM 解析\nCSS 会阻塞DOM的渲染")])]),s._v(" "),t("p",[s._v("为了避免这种情况，应该以下原则：")]),s._v(" "),t("p",[s._v("CSS 资源排在 JavaScript 资源前面\nJS 放在 HTML 最底部，也就是 前")]),s._v(" "),t("p",[s._v("另外，如果要改变阻塞模式，可以使用 defer 与 async")]),s._v(" "),t("p",[s._v("defer 会按照顺序在 DOMContentLoaded 前按照页面出现顺序依次执行。")]),s._v(" "),t("p",[s._v("async 则是下载完立即执行")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v('普通script浏览器会做如下处理\n停止解析 document.。阻塞dom解析\n请求 a.js\n执行 a.js 中的脚本\n继续解析 document\n\ndefer\n<script src="d.js" defer><\/script>\n<script src="e.js" defer><\/script>\n不阻止解析 document， 并行下载 d.js, e.js\n即使下载完 d.js, e.js 仍继续解析 document\n按照页面中出现的顺序，在其他同步脚本执行后，DOMContentLoaded 事件前 依次执行 d.js, e.js。\n\nasync\n<script src="b.js" async><\/script>\n<script src="c.js" async><\/script>\n不阻止解析 document, 并行下载 b.js, c.js\n当脚本下载完后立即执行。（两者执行顺序不确定，执行阶段不确定，可能在 DOMContentLoaded 事件前或者后 ）\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("h3",{attrs:{id:"js"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#js"}},[s._v("#")]),s._v(" JS")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("词法分析：分词、解析、代码生成")])]),s._v(" "),t("li",[t("p",[s._v("预编译：全局环境、函数环境、eval")])]),s._v(" "),t("li",[t("p",[s._v("执行：JS引擎线程、事件触发线程、定时器触发线程、http异步请求线程")])]),s._v(" "),t("li",[t("p",[s._v("宏任务：同步任务、异步任务（AJAX、DOM事件、setTimeout）")])]),s._v(" "),t("li",[t("p",[s._v("微任务：ES6和Node环境下的。Promise、process.nextTick")])])]),s._v(" "),t("hr"),s._v(" "),t("p",[s._v("参考:")]),s._v(" "),t("p",[s._v("https://juejin.cn/post/6844903951456796680")]),s._v(" "),t("p",[s._v("https://juejin.cn/post/6844903784229896199")])])}),[],!1,null,null,null);t.default=a.exports}}]);